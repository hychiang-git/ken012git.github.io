<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>State Space Models | Hung-Yueh Chiang</title> <meta name="author" content="Hung-Yueh Chiang"> <meta name="description" content="State Space Models"> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="/assets/img/ut_shield.png"> <link rel="stylesheet" href="/assets/css/main.css"> <link rel="canonical" href="/blog/2024/state_space_models/"> </head> <body class="fixed-top-nav sticky-bottom-footer"> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <img width="60px" src="/assets/img/ut_longhorns.webp" class="navbar-brand logo" alt="blank logo"> <a class="navbar-brand title font-weight-lighter" href="/"><span class="font-weight-bold">Hung-Yueh </span>Chiang</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">About</a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">Blog<span class="sr-only">(current)</span></a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">Publications</a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">Projects</a> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">State Space Models</h1> <p class="post-meta">July 11, 2024</p> <p class="post-tags"> <a href="/blog/2024"> <i class="fas fa-calendar fa-sm"></i> 2024 </a>   ·   <a href="/blog/tag/ml"> <i class="fas fa-hashtag fa-sm"></i> ml</a>   <a href="/blog/tag/paper"> <i class="fas fa-hashtag fa-sm"></i> paper</a>   <a href="/blog/tag/algorithm"> <i class="fas fa-hashtag fa-sm"></i> algorithm</a>   <a href="/blog/tag/ssm"> <i class="fas fa-hashtag fa-sm"></i> SSM</a>   </p> </header> <article class="post-content"> <style>#tableOfContents{font-size:1.6em}</style> <details style="background-color: #F5F5F5;"> <summary id="tableOfContents">Table of Contents</summary> <ul style="font-size:1.4em"> <li><a href="#introduction">Introduction</a></li> <li><a href="#continuous-state-space-model">Continuous State Space Model</a></li> <li><a href="#discretize-continuous-state-space-model">Discretize Continuous State Space Model</a></li> <ul> <li><a href="#bilinear-transform">Bilinear Transform</a></li> <li><a href="#zero-order-hold-transform">Zero-order Hold Transform</a></li> </ul> <li><a href="#discrete-time-state-space-model">Discrete-time State Space Model</a></li> <ul> <li><a href="#convolution-form&lt;">Convolution Form</a></li> <li><a href="#parallel-associative-scan">Parallel Associative Scan</a></li> </ul> <li><a href="#references">References</a></li> </ul> </details> <p><br></p> <h1 id="introduction">Introduction</h1> <p>This document provides the mathematic derivations of the State Space Models that help readers understand the formulas. The contents are extracted and summarized from the original papers cited in <a href="#references">references</a>.</p> <p><br></p> <h1 id="continuous-state-space-model">Continuous State Space Model</h1> <p>Consider a continuous state space model equation:</p> \[\label{c_ssm} \tag{1} \Large \begin{aligned} \dot{h}(t)=Ah(t)+Bx(t) \\ y(t)=Ch(t)+Dx(t) \end{aligned}\] <p>There are three continuous signals in the system: \(x(t), h(t), y(t)\), which are:</p> <ol> <li> <p>\(x(t)\in \mathbb{R}^p\) is the <code class="language-plaintext highlighter-rouge">input (or control) vector</code> that describes the input continuous signal. Some papers would use \(u\) as the input vector, but we use \(x\) for better aligning with Mamba series.</p> </li> <li> <p>\(h(t)\in \mathbb{R}^n\) is the <code class="language-plaintext highlighter-rouge">state vector</code> that describes the system states, and \(\dot{h}\) is the system dynamics <em>i.e.</em> \(\frac{\partial h(t)}{\partial t}\). Some papers would use \(x\) as the state vector, but we use \(h\) for better aligning with Mamba series.</p> </li> <li> <p>\(y(t) \in \mathbb{R}^q\) is the <code class="language-plaintext highlighter-rouge">output vector</code> that describes the output continuous signal from the system.</p> </li> </ol> <p>There are four transition matrices in the system: \(A, B, C,\) and \(D\), which are:</p> <ol> <li> <p>\(A, \texttt{Dim}(A)=n\times n\) is the <code class="language-plaintext highlighter-rouge">state matrix</code> of the system that describes the linear relations of the parameters in the system.</p> </li> <li> <p>\(B, \texttt{Dim}(B)=n\times p\) is the <code class="language-plaintext highlighter-rouge">input matrix</code> that describes how input signals interact with the system.</p> </li> <li> <p>\(C, \texttt{Dim}(C)=q\times n\) is the <code class="language-plaintext highlighter-rouge">output matrix</code> that describes the system output.</p> </li> <li> <p>\(D, \texttt{Dim}(D)=q\times p\) is the <code class="language-plaintext highlighter-rouge">feed-forward matrix</code> that describes how input signals are directly involved in the output.</p> </li> </ol> <p><br></p> <h1 id="discretize-continuous-state-space-model">Discretize Continuous State Space Model</h1> <p>The general formulation of an ODE is \(\begin{aligned} \frac{d}{dt}h(t) = A h(t) + B x(t). \end{aligned}\)</p> <p>From the differential equation, we have \(\begin{aligned} h(t+\Delta t) - h(t) = \int_{s=t}^{s=t+\Delta t} A h(s) + B x(s)ds . \end{aligned}\)</p> <h2 id="bilinear-transform">Bilinear Transform</h2> <p>By the Trapezoidal rule, we have</p> \[\begin{aligned} h(t+\Delta t) - h(t) &amp;= \Delta t \frac{(Ah(t) + Bx(t) + Ah(t+\Delta t) + B x(t+\Delta t))}{2} \\ &amp;= \frac{\Delta t}{2} Ah(t) + \frac{\Delta t}{2}Bx(t) + \frac{\Delta t}{2}Ah(t+\Delta t) + \frac{\Delta t}{2}Bx(t+\Delta t) \end{aligned}\] <p>By combining the terms, we have</p> \[\begin{aligned} \textcolor{red}{h(t+\Delta t)} - \frac{\Delta t}{2}A\textcolor{red}{h(t+\Delta t)} &amp;= \textcolor{green}{h(t)} + \frac{\Delta t}{2} A \textcolor{green}{h(t)} + \textcolor{blue}{\frac{\Delta t}{2}B} x(t) + \textcolor{blue}{\frac{\Delta t}{2}B} x(t+\Delta t) \\ ( \mathbf{I} - \frac{\Delta t}{2}A)h(t+\Delta t) &amp;= ( \mathbf{I}+ \frac{\Delta t}{2} A)h(t) + \frac{\Delta t}{2} B(x(t) + x(t+\Delta t)) \\ h(t+\Delta t) &amp;= ( \mathbf{I} - \frac{\Delta t}{2}A)^{-1} ( \mathbf{I}+ \frac{\Delta t}{2} A) h(t) + \frac{\Delta t}{2} ( \mathbf{I} - \frac{\Delta t}{2}A)^{-1} B (x(t) + x(t+\Delta t)) \end{aligned}\] <p>Since \(x\) is the constant and does no involve in the integral, we have \(x(t) = x(t+\Delta t)\)</p> \[\begin{aligned} h(t+\Delta t) &amp;= ( \mathbf{I} - \frac{\Delta t}{2}A)^{-1} ( \mathbf{I}+ \frac{\Delta t}{2} A) h(t) + \Delta t ( \mathbf{I} - \frac{\Delta t}{2} A)^{-1} B x(t+\Delta t) \end{aligned}\] <p>We can replace \(\frac{1}{2}\) with a variable \(\alpha\), so that we have Generalized Bilinear Transformation (GBT).</p> \[\begin{aligned} h(t+\Delta t) &amp;= \textcolor{red}{( \mathbf{I} - \Delta t \alpha A)^{-1} ( \mathbf{I}+ \Delta t \alpha A)} h(t) + \textcolor{green}{\Delta t ( \mathbf{I} - \Delta t \alpha A)^{-1} B} x(t+\Delta t) \end{aligned}\] <p>We can write the discretized state space model as</p> \[\begin{aligned} h[t+1] &amp;= \overline{A} h[t] + \overline{B} x[t+1] \\ y[t+1] &amp;= Ch[t+1]+Dx[t+1] \end{aligned}\] <p>where \(\overline{A}, \overline{B}\) are discretized matrices</p> \[\begin{aligned} \overline{A} &amp;= \textcolor{red}{(\mathbf{I} - \Delta t \alpha A)^{-1} ( \mathbf{I}+ \Delta t \alpha A)} \\ \overline{B} &amp;= \textcolor{green}{\Delta t ( \mathbf{I} - \Delta t \alpha A)^{-1} B} \end{aligned}\] <p><br></p> <h2 id="zero-order-hold-transform-zoh">Zero-order Hold Transform (ZOH)</h2> <h4 id="state-solution">State solution</h4> <p>We derive the state solution from the continuous time-invariant dynamic equation \(\frac{d}{dt}h(t) = A h(t) + Bx(t)\) and move \(A h(t)\) to the left-hand side</p> \[\begin{aligned} \textcolor{red}{ \frac{d}{dt}h(t) - A h(t) } = Bx(t) . \end{aligned}\] <p>Using the fact</p> \[\begin{aligned} \textcolor{red}{\frac{d}{dt}[e^{-At}h(t)]} = e^{-At} \frac{d}{dt}h(t) - e^{-At} A h(t) = \textcolor{green}{e^{-At}} [ \textcolor{red}{\frac{d}{dt}h(t) - A h(t)} ] \end{aligned}\] <p>, we have</p> \[\begin{aligned} \textcolor{red}{\frac{d}{dt}[e^{-At}h(t)]} = \textcolor{green}{e^{-At}} Bx(t) \\ \end{aligned}\] <p>We integrate the both side from \(0\) to \(t\)</p> \[\begin{aligned} \int_0^t \frac{d}{d \tau}[e^{-A\tau}h(\tau)] d\tau = \textcolor{red}{e^{-At}h(t) - h(0) = \int_0^t e^{-A\tau} Bx(\tau) d \tau} \\ \end{aligned}\] <p>and move \(h(0)\) to the right-hand side</p> \[\begin{aligned} e^{-At}h(t) = h(0) + \int_0^t e^{-A\tau} Bx(\tau) d \tau \end{aligned}\] <p>After multiplying \(e^{At}\) on both sides, we have the state solution</p> \[\label{state_solution} \tag{eq:1} \begin{aligned} h(t) = e^{At}h(0) + \int_0^t e^{A(t-\tau)} Bx(\tau) d \tau \end{aligned}\] <p>Note that \(\int_0^t e^{A(t-\tau)} Bx(\tau) d \tau\) is a convolution, which can be done efficiently by multiplying the scalars in the frequency domain. We will use this result to derive the Zero-order Hold discretization.</p> <p><br></p> <h4 id="zero-order-hold-discretization">Zero-order Hold Discretization</h4> <p>We first define the relationship between discretized signals and continuous signals.</p> \[\begin{aligned} h[k] := h(k\Delta t), \quad \text{and} \quad x[k] := x(k\Delta t) \end{aligned}\] <p>where \(h[x]\) and \(c[k]\) is a zero-order transformed signals from \(h(x)\) and \(x(x)\) with a sampling step \(k\).</p> <p>Then using <a href="#eq:1">[eq:1]</a>, we have</p> \[\begin{aligned} h[k+1] &amp;:= h(\textcolor{red}{(k+1)\Delta t}) \\ &amp;= e^{A\textcolor{red}{(k+1)\Delta t}}h(0) + \int_0^{\textcolor{red}{(k+1)\Delta t}} e^{A(\textcolor{red}{(k+1)\Delta t}-\tau)} Bx(\tau) d \tau \\ &amp;= e^{A(k+1)\Delta t}h(0) + \int_{\textcolor{green}{0}}^{\textcolor{green}{k\Delta t}} e^{A((k+1)\Delta t-\tau)} Bx(\tau) d \tau + \int_{\textcolor{green}{k\Delta t}}^{\textcolor{green}{(k+1)\Delta t}} e^{A((k+1)\Delta t-\tau)} Bx(\tau) d \tau \\ &amp;= \textcolor{red}{e^{A\Delta t}}e^{Ak\Delta t}h(0) + \int_0^{k\Delta t} \textcolor{red}{e^{A\Delta t}} e^{A(k\Delta t-\tau)} Bx(\tau) d \tau + \int_{k\Delta t}^{(k+1)\Delta t} e^{A((k+1)\Delta t-\tau)} Bx(\tau) d \tau \\ &amp;= e^{A\Delta t}\left( \textcolor{green}{ e^{Ak\Delta t}h(0) + \int_0^{k\Delta t} e^{A(k\Delta t-\tau)} Bx(\tau) d \tau} \right) + \int_{k\Delta t}^{(k+1)\Delta t} e^{A((k+1)\Delta t-\tau)} Bx(\tau) d \tau \\ &amp;= e^{A\Delta t} \textcolor{green}{h(k\Delta t)} + \int_{k\Delta t}^{(k+1)\Delta t} e^{A((k+1)\Delta t-\tau)} Bx(\tau) d \tau \\ &amp;= e^{A\Delta t} h[k] + e^{A((k+1)\Delta t} B \textcolor{red}{\int_{k\Delta t}^{(k+1)\Delta t} e^{-A\tau} x(\tau) d \tau} \\ &amp;= e^{A\Delta t} h[k] + e^{A((k+1)\Delta t} B (\textcolor{red}{-A^{-1}e^{-A\tau}\Big|_{k\Delta t}^{(k+1)\Delta t}})x((k+1)\Delta t) \\ &amp;= e^{A\Delta t} h[k] + e^{A((k+1)\Delta t} B (\textcolor{red}{-A^{-1}e^{-A(k+1)\Delta t} + -A^{-1}e^{-A k\Delta t}}) x((k+1)\Delta t) \\ &amp;= e^{A\Delta t} h[k] + e^{A((k+1)\Delta t} B (\textcolor{red}{-A^{-1}})(e^{-A(k+1)\Delta t} + e^{-A k\Delta t}) x((k+1)\Delta t) \\ &amp;= e^{A\Delta t} h[k] + \textcolor{green}{e^{A((k+1)\Delta t}} B (-A^{-1}) (\textcolor{green}{e^{-A(k+1)\Delta t} + e^{-A k\Delta t}}) x((k+1)\Delta t) \\ &amp;= e^{A\Delta t} h[k] + BA^{-1} (\textcolor{green}{-\mathbf{I} + e^{A \Delta t}}) x[k+1] \\ &amp;= \textcolor{red}{e^{A\Delta t}} h[k] + \textcolor{green}{\frac{\Delta t B}{\Delta t A} (e^{A \Delta t} - \mathbf{I})} x[k+1] \\ \end{aligned}\] <p>Note that \(x\) is constant from \(k\Delta t\) to \((k+1)\Delta t\), and thereby \(x(k\Delta t) = x((k+1)\Delta t)\)</p> <p>We can write the discretized state space model as</p> \[\begin{aligned} h[t+1] &amp;= \overline{A} h[t] + \overline{B} x[t+1] \\ y[t+1] &amp;= Ch[t+1]+Dx[t+1] \end{aligned}\] <p>where \(\overline{A}, \overline{B}\) are discretized matrices</p> \[\begin{aligned} \overline{A} &amp;= \textcolor{red}{e^{A\Delta t}} \\ \overline{B} &amp;= \textcolor{green}{ {(A \Delta t)}^{-1} (e^{A \Delta t} - \mathbf{I}) \Delta t B} \end{aligned}\] <p>We can perform an Euler approximation to simplify \(B\). The first-order Taylor expansion of \(e^{A \Delta t}\) around zero is given by:</p> \[\begin{aligned} e^{A \Delta t} \approx I + A \Delta t \end{aligned}\] <p>Therefore, we have</p> \[\begin{aligned} \overline{B} &amp;= {(A \Delta t)}^{-1} (\textcolor{red}{e^{A \Delta t}} - \mathbf{I}) \Delta t B \approx {(A \Delta t)}^{-1} (\textcolor{red}{I + A \Delta t} - \mathbf{I}) \Delta t B = \Delta t B \end{aligned}\] <h1 id="discrete-time-state-space-model">Discrete-time State Space Model</h1> <p>We can write the continuous-time state space model</p> \[\begin{aligned} \dot{x}(t)=Ax(t)+Bu(t) \\ y(t)=Cx(t)+Du(t) \end{aligned}\] <p>as a discrete-time state space model</p> \[\begin{aligned} x[t] &amp;= \overline{A} x[t-1] + \overline{B} u[t] \\ y[t] &amp;= C x[t] + D u[t] \\ \end{aligned}\] <p>by using the GBL or ZOH</p> \[\begin{aligned}[c] &amp;\text{Bilinear:}\\ \overline{A}&amp;= (\mathbf{I} - \Delta t \alpha A)^{-1} ( \mathbf{I}+ \Delta t \alpha A)\\ \overline{B} &amp;= \Delta t ( \mathbf{I} - \Delta t \alpha A)^{-1} B \end{aligned} \quad\quad \begin{aligned}[c] &amp;\text{ZOH:}\\ \overline{A} &amp;= e^{A\Delta t}\\ \overline{B} &amp;= {(\Delta t A)}^{-1} (e^{A \Delta t} - \mathbf{I}) \Delta t B \approx \Delta t B\\ \end{aligned}\] <p><br></p> <h2 id="convolution-form">Convolution Form</h2> <p>Letting \(h_{-1} = 0\) and unrolling the \(y_k\)</p> \[\begin{aligned}[c] &amp;\text{t=0}\\ h_0 &amp;= \overline{B}x_0\\ y_0 &amp;= C\overline{B}x_0 + Dx_0\\ \end{aligned} \quad \begin{aligned}[c] &amp;\text{t=1}\\ h_1 &amp;= \overline{A}\overline{B}x_0 + \overline{B}x_1\\ y_1 &amp;= C\overline{A}\overline{B}x_0 + C\overline{B}x_1 + Dx_1\\ \end{aligned} \quad \begin{aligned}[c] &amp;\text{t=2}\\ h_2 &amp;= \overline{A}^2\overline{B}x_0 + \overline{A}\overline{B}x_1 + \overline{B}x_2\\ y_2 &amp;= C\overline{A}^2\overline{B}x_0 + C\overline{A}\overline{B}x_1 + C\overline{B}x_2 + Dx_2\\ \end{aligned}\] <p>Therefore, when \(t=k\)</p> \[\begin{aligned} h_k &amp;= \overline{A}^k\overline{B}x_0 +...+ \overline{A}\overline{B}x_{k-1} + \overline{B}x_k\\ y_k &amp;= C\overline{A}^k\overline{B}x_0 + C\overline{A}^{k-1}\overline{B}x_1 +...+ C\overline{A}\overline{B}x_{k-1} + C\overline{B}x_k + Dx_k \\ \end{aligned}\] <p>In other words, \(y_t\) is a single (non-circular) convolution</p> \[\begin{aligned} y_t = \sum_{\tau=0}^k \overline{C}\overline{A}^{\tau}\overline{B} x_{t-\tau} + Dx_t \end{aligned}\] <p>which can be computed very efficiently with FFTs, provided that \(\overline{K}\) is known.</p> <p>\(\begin{aligned} y_t = \overline{K} \ast x + Dx_t \end{aligned}\) where \(\begin{aligned} \overline{K} \in \mathbb{R}^L := \kappa_L(\overline{A}, \overline{B}, \overline{C}) := (\overline{C}\overline{A}^i\overline{B})_{i \in [L]} = (\overline{C}\overline{B}, \overline{C}\overline{A}\overline{B}, ..., , \overline{C}\overline{A}^{L-1}\overline{B}) \end{aligned}\)</p> <p><br></p> <h2 id="parallel-associative-scan">Parallel Associative Scan</h2> <p>Consider an example for illustrating a parallel associative scan (or parallel prefix sum/scan): \(\begin{aligned} h_t &amp;= \overline{A} h_{t-1} + \overline{B} x_t \\ \end{aligned}\)</p> <p>We unroll the recursive equation with \(h_0 = 0\).</p> \[\begin{aligned} h_1 &amp;= \overline{B} x_1 \\ h_2 &amp;= \overline{A} h_1 + \overline{B} x_2 = \overline{A}\overline{B} x_1 + \overline{B} x_2\\ h_3 &amp;= \overline{A} h_2 + \overline{B} x_3 = \overline{A}(\overline{A}\overline{B} x_1 + \overline{B} x_2) + \overline{B} x_3 = \overline{A}^2\overline{B} x_1 + \overline{A}\overline{B} x_2 + \overline{B} x_3\\ h_4 &amp;= \overline{A} h_3 + \overline{B} x_4 = \overline{A}(\overline{A}^2\overline{B} x_1 + \overline{A}\overline{B} x_2 + \overline{B} x_3) + \overline{B} x_4 = \overline{A}^3\overline{B} x_1 + \overline{A}^2\overline{B} x_2 + \overline{A}\overline{B} x_3 + \overline{B} x_4\\ \end{aligned}\] <p>Define an operand \(e_i = (\overline{A}, \overline{B}x_i)\) and operator \(e_i \cdot e_j\) for parallel associative scan such that</p> \[\begin{aligned} e_1 \cdot e_2 &amp;= (\overline{A}, \overline{B}x_1) \cdot (\overline{A}, \overline{B}x_2) = (\overline{A}^2, \overline{A}\overline{B}x_1 + \overline{B}x_2) = (\overline{A}^2, h_2) \\ e_1 \cdot e_2 \cdot e_3 &amp;= (\overline{A}^2, \overline{A}\overline{B}x_1 + \overline{B}x_2) \cdot (\overline{A}, \overline{B}x_3) = (\overline{A}^3, \overline{A}^2\overline{B} x_1 + \overline{A}\overline{B} x_2 + \overline{B} x_3) = (\overline{A}^2, h_3) \\ \end{aligned}\] <p>Therefore, we can parallelize the computation with a parallel associative scan into a tree structure, for example, \(h_4\) can be computed by</p> \[\begin{aligned} (e_1 \cdot e_2 \cdot e_3 \cdot e_4) &amp;= (e_1 \cdot e_2) \cdot (e_3 \cdot e_4) \\ &amp;= (\overline{A}^2, \overline{A}\overline{B}x_1 + \overline{B}x_2) \cdot (\overline{A}^2, \overline{A}\overline{B}x_3 + \overline{B}x_4) \\ &amp; = (\overline{A}^4, \overline{A}^3\overline{B} x_1 + \overline{A}^2\overline{B} x_2 + \overline{A}\overline{B} x_3 + \overline{B} x_4) \\ &amp; = (\overline{A}^4, h_4) \\ \end{aligned}\] <h1 id="references">References</h1> <p><a id="1">[1]</a> A. Gu, T. Dao, S. Ermon, A. Rudra, and C. Ré, “Hippo: Recurrent memory with optimal polynomial projections,” Advances in neural information processing systems, vol. 33, pp. 1474– 1487, 2020.</p> <p><a id="2">[2]</a> A. Gu, K. Goel, A. Gupta, and C. Ré, “On the parameterization and initialization of diagonal state space models,” Advances in Neural Information Processing Systems, vol. 35, pp. 35971–35983, 2022.</p> <p><a id="3">[3]</a> A. Gu and T. Dao, “Mamba: Linear-time sequence modeling with selective state spaces,” arXiv preprint arXiv:2312.00752, 2023.</p> <p><a id="4">[4]</a> <a href="https://en.wikipedia.org/wiki/State-space_representation" rel="external nofollow noopener" target="_blank">https://en.wikipedia.org/wiki/State-space_representation</a></p> </article><div id="disqus_thread" style="max-width: 1000px; margin: 0 auto"></div> <script type="text/javascript">var disqus_shortname="https-hychiang-info",disqus_identifier="/blog/2024/state_space_models",disqus_title="State Space Models";!function(){var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src="//"+disqus_shortname+".disqus.com/embed.js",(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(e)}();</script> <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript" rel="external nofollow noopener" target="_blank">comments powered by Disqus.</a> </noscript> </div> </div> <footer class="sticky-bottom mt-5"> <script type="text/javascript" id="clustrmaps" src="//cdn.clustrmaps.com/map_v2.js?cl=ffffff&amp;w=190&amp;t=tt&amp;d=63L-AOUUXV7dNP9sE0J35-A9m9tVx4XT7qV2CT9AAC8&amp;co=2d78ad&amp;cmo=3acc3a&amp;cmn=ff5353&amp;ct=ffffff"></script> <div class="container"> © Copyright 2025 Hung-Yueh Chiang. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Last updated: August 31, 2025. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js" integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js"></script> <script defer src="/assets/js/common.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"},chtml:{scale:.9},svg:{scale:.9}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>